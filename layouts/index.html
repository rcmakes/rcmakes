{{ define "main" }}

<!-- Alerts -->
<script>
  //var fetch = require("node-fetch"); // or fetch() is native in browsers
  var makeQuerystring = params =>
    Object.keys(params)
      .map(key => {
        return encodeURIComponent(key) + "=" + encodeURIComponent(params[key]);
      })
      .join("&");
  
  var url = "https://www.googleapis.com/calendar/v3/calendars/rcmakes.calendar@gmail.com/events";
  var querystring = makeQuerystring({
    q: "Makerspace"
  });
var today = new Date();
var yearRn = today.getFullYear()
var monthRn = today.getMonth()+1
var dayRn = today.getDate()
var hoursRn = today.getHours()
var minutesRn = today.getMinutes()
var datetime = new Date(yearRn, monthRn, dayRn, hoursRn, 00,00) //+ ":" + minutesRn +":00"
console.log(datetime)
console.log("Hour: " + hoursRn)
console.log("Todays Date: " + dayRn)
console.log("This is the current year " + yearRn)
console.log("Today's Month " + monthRn)
var indexarray = []
fetch(url + "?" + querystring, {
    method: "get",
    headers: {
      Authorization: "Bearer ya29.GlsNB64n-PjwbN4Kznzezh2A8oQI_XZOeSJVmK_L_14cqTThoaKuORlyKV5CgkoiW0QIGzxN6X2xig4GP6-e-lgT16IPE5WFY9WmvX02WGdHglNaoaS0H4rESJds"
    }
  })
  .then(res => res.json())
  .then(json => values = json.items)
  .then(values => values.some((element, index) => {
    var date = element.end.dateTime.split('-');
    console.log(date)
    var newdate = new Date(date[0], date[1]-1, date[2].split("T")[0], date[2].split("T")[1].split(":")[0])
    console.log(newdate)
    if(newdate >= datetime){
      indexarray.push(newdate)
    }
    console.log(indexarray)
    
    var mydate = new Date(newdate[0], newdate[1] , newdate[2]);
    console.log(indexarray[0])


  }))
console.log(indexarray[0])
</script>
<section class="alert alert-success">
  
  <div class="row">
    
    <div class="col-lg-12">
      <p class="mt-2 text-center h5">
        The Community Makerspace will be open next on May 4th
      </p>
    </div>

  </div>

</section>

<section class="row">

  <div class="col-lg-12">

    <div class="jumbotron py-3">
      <div class="row">
        <div class="col-lg-12">
          <h1 class="display-responsive pb-3 text-center">
            Student-Powered Entrepreneurship
          </h1>          
        </div>
      </div>

      <div class="row">
        <div class="col-lg-6 my-flex-item pb-3">
          <p class="lead">
            RCMakes is a non-profit conglomerate operated by students at Rancho Campana High School. Services include an online store selling wares made by students, a community makerspace, a build-to-spec job shop for individual and business customers, expanded learning programs for incoming and current high school students, video production, software development and graphic design.
          </p>
          <hr class="my-4">
          <p>
            We produce goods and services, provide internships and student employment, award earned academic
            scholarships, and incubate startup businesses.
          </p>
          <p class="lead">
            <a class="btn btn-primary btn-lg" href="/about" role="button">Learn More</a>
          </p>
        </div>
        <div class="col-lg-6 my-2">
          {{ partial "carousel-homepage" . }}
        </div>
      </div>
    </div>
    <div class="mt-2">
      {{partial "services" .}}
    </div>

  </div>

</section>

<div class="mt-4">
  {{ partial "clients" . }}
</div>


{{ end }}
